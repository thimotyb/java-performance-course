This is the fix adding some synchronized blocks
